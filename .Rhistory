geom_point(data = wm.df %>% filter(year %in% seq(1990,2000)), aes(x = lon, y = lat,
frame = month, cumulative = TRUE),
size = 1, alpha = 0.2, color = "yellow") +
# scale_color_viridis(option = "B") +
labs(title = paste0("Map of Watermain Breaks: "),
subtitle = paste0("City of Toronto (1990-2016)")) +
theme(axis.text = element_blank(), axis.title = element_blank(),
axis.ticks = element_blank(), panel.background = element_rect(fill = "grey95",colour = "grey5"),
legend.background = element_rect(fill = "grey95"),
panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
plot.title = element_text(size = title.size, face = "bold"),
plot.subtitle = element_text(size = title.size*0.6, face = "plain"),
plot.background = element_rect(fill = "grey95")) +
facet_wrap(~year)
pout1 <- ggmap(TO_map2, extent = "panel", darken = 0.8) +
geom_point(data = wm.df %>% filter(year %in% seq(1990,2001)), aes(x = lon, y = lat,
frame = month, cumulative = TRUE),
size = 1, alpha = 0.2, color = "yellow") +
# scale_color_viridis(option = "B") +
labs(title = paste0("Map of Watermain Breaks: "),
subtitle = paste0("City of Toronto (1990-2016)")) +
theme(axis.text = element_blank(), axis.title = element_blank(),
axis.ticks = element_blank(), panel.background = element_rect(fill = "grey95",colour = "grey5"),
legend.background = element_rect(fill = "grey95"),
panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
plot.title = element_text(size = title.size, face = "bold"),
plot.subtitle = element_text(size = title.size*0.6, face = "plain"),
plot.background = element_rect(fill = "grey95")) +
facet_wrap(~year)
gganimate(pout1, filename = "wm_month_yr_map.gif", title_frame = TRUE)
ggplot(data = wm.df %>% filter(year == 1990), aes(x = X_coord, y = Y_coord, color = as.factor(month), frame = week, cumulative = TRUE)) +
geom_point(size = 1.5, alpha = 0.5) +
scale_color_viridis(option = "B", discrete = TRUE) +
labs(title = paste0("Map of Watermain Breaks"),
subtitle = paste0("City of Toronto (1990-2016)")) +
theme(axis.text = element_blank(), axis.title = element_blank(),
axis.ticks = element_blank(), panel.background = element_rect(fill = "grey95",colour = "grey5"),
legend.background = element_rect(fill = "grey95"),
panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
plot.title = element_text(size = title.size, face = "bold"),
plot.subtitle = element_text(size = title.size*0.6, face = "plain"),
plot.background = element_rect(fill = "grey95"))
ggmap(TO_map2, extent = "panel", darken = 0.8) +
geom_point(data = wm.df %>% filter(year %in% seq(1990,2001)), aes(x = lon, y = lat,
frame = month, cumulative = TRUE),
size = 1, alpha = 0.2, color = "yellow") +
# scale_color_viridis(option = "B") +
labs(title = paste0("Map of Watermain Breaks: "),
subtitle = paste0("City of Toronto (1990-2016)")) +
theme(axis.text = element_blank(), axis.title = element_blank(),
axis.ticks = element_blank(), panel.background = element_rect(fill = "grey95",colour = "grey5"),
legend.background = element_rect(fill = "grey95"),
panel.grid.minor = element_blank(), panel.grid.major = element_blank(),
plot.title = element_text(size = title.size, face = "bold"),
plot.subtitle = element_text(size = title.size*0.6, face = "plain"),
plot.background = element_rect(fill = "grey95")) +
facet_wrap(~year)
library(rgdal)
library(sp)
library(sf)
list.files()
list.files("data")
list.files("data", "WatermainBreaks_wgs84")
library(here)
readOGR(here::here("data", "WatermainBreaks_wgs84"))
raw_d <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
raw_d %>% glimpse()
library(dplyr)
raw_d %>% glimpse()
raw_d %>% plot
raw_d
raw_d %>% select(XCOORD, YCOORD)
leaflet::leaflet(raw_d) %>% addTiles
library(leaflet)
leaflet::leaflet(raw_d) %>% addTiles()
raw_d %>% select(XCOORD, YCOORD)
raw_d %>% dplyr::select(XCOORD, YCOORD)
class(raw_d)
raw_d <- st_as_sf(raw_d)
raw_d %>% glimpse()
raw_d %>% dplyr::select(XCOORD, YCOORD)
leaflet::leaflet(raw_d) %>% addTiles()
raw_d %>% dplyr::select(-XCOORD, -YCOORD)
d_raw <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
sf_d <- st_as_sf(d_raw)
sf_d %>% glimpse()
sf_d <- sf_d %>% dplyr::select(-XCOORD, -YCOORD)
leaflet::leaflet(sf_d) %>% addTiles()
sf_d
plot(sf_d)
d_raw
library(leaflet)
library(dplyr)
list.files("data", "WatermainBreaks_wgs84")
d_raw <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
sf_d <- st_as_sf(d_raw)
sf_d %>% glimpse()
sf_d <- sf_d
sf_d
leaflet::leaflet(sf_d) %>% addTiles()
leaflet::leaflet(sf_d) %>% addTiles(~XCOORD, ~YCOORD)
leaflet::leaflet(sf_d) %>% addTiles(~XPOINT, ~YPOINT)
names(sf_d)
leaflet::leaflet(sf_d) %>% addTiles(~POINT_X, ~POINT_Y)
sf::st_crs(sf_d)
sf::st_set_crs(sf_d, 26917)
sf::st_set_crs(sf_d, "26917")
sf_d <- sf::st_set_crs(sf_d, 26917)
sf_d
leaflet::leaflet(sf_d) %>% addTiles()
crs(sf_d)
CRS(sf_d)
sf::st_crs(sf_d)
leaflet::leafletCRS(sf::st_crs(sf_d))
leaflet::leafletCRS(proj4def = sf::st_crs(sf_d))
crs <- leaflet::leafletCRS(proj4def = sf::st_crs(sf_d))
leaflet(options = leafletOptions(worldCopyJump = F, crs = crs))
leaflet::leaflet(sf_d) %>% addTiles()
crs <- leaflet::leafletCRS(proj4def = sf::st_crs(sf_d))
crs
sf::st_crs(sf_d) #CRS
sf::st_set_crs(sf_d, 4326)
sf::st_set_crs(sf_d, 4326)
sf_d <- sf::st_set_crs(sf_d, 4326)
crs <- leaflet::leafletCRS(proj4def = sf::st_crs(sf_d))
leaflet(options = leafletOptions(worldCopyJump = F, crs = crs))
leaflet::leaflet(sf_d) %>% addTiles()
leaflet(options = leafletOptions(crs = crs))
leaflet::leaflet(sf_d) %>% addTiles()
crs
rm(list=ls())
library(here)
library(rgdal)
library(sp)
library(sf)
library(leaflet)
library(dplyr)
list.files("data", "WatermainBreaks_wgs84")
d_raw <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
sf_d <- st_as_sf(d_raw)
sf_d %>% glimpse()
sf::st_crs(sf_d) #CRS
library(here)
library(rgdal)
library(sp)
library(sf)
library(leaflet)
library(dplyr)
list.files("data", "WatermainBreaks_wgs84")
d_raw <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
sf_d <- st_as_sf(d_raw)
sf_d %>% glimpse()
sf::st_crs(sf_d) #CRS
sf_d <- sf::st_set_crs(sf_d, 4326)
crs <- leaflet::leafletCRS(proj4def = sf::st_crs(sf_d))
st_crs(sf_d) <- crs
st_crs(sf_d) <- sf::st_crs(sf_d)
leaflet(options = leafletOptions(crs = crs))
leaflet::leaflet(sf_d) %>% addTiles()
leaflet::leaflet(sf_d) %>% addTiles(~XCOORD, ~YCOORD)
sf_d
leaflet::leaflet(sf_d) %>% addTiles(~POINT_X, ~POINT_Y)
data(quaks)
data(quakes)
quakes
sf_d
library(here)
library(rgdal)
library(sp)
library(sf)
library(leaflet)
library(dplyr)
list.files("data", "WatermainBreaks_wgs84")
d_raw <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
sf_d <- st_as_sf(d_raw)
sf_d %>% glimpse()
sf::st_crs(sf_d) #CRS
leaflet::leaflet(sf_d) %>% addTiles(~POINT_X, ~POINT_Y)
sf_d
sf_d[0]
df <- st_geometry(sf_d) <- NULL
df
st_geometry(sf_d) <- NULL
df <- sf_d
df
leaflet(data = df) %>% addTiles
leaflet(data = df) %>% addTiles(~POINT_X,~POINT_Y)
leaflet(data = df) %>% addMarkers(~POINT_X,~POINT_Y)
leaflet(data = df %>% filter(BREAK_YEAR == 2016)) %>%
addMarkers(~POINT_X,~POINT_Y)
leaflet(data = df %>% filter(BREAK_YEAR == 2016)) %>% addTiles() %>%
addMarkers(~POINT_X,~POINT_Y)
colnames(df)
leaflet(data = df %>% filter(BREAK_YEAR == 2016)) %>% addTiles() %>%
addMarkers(~POINT_X, ~POINT_Y, ~BREAK_DATE)
leaflet(data = df %>% filter(BREAK_YEAR == 2016)) %>% addTiles() %>%
addMarkers(~POINT_X, ~POINT_Y, popup = ~BREAK_DATE)
leaflet(data = df %>% filter(BREAK_YEAR == 2016)) %>% addTiles() %>%
addMarkers(~POINT_X, ~POINT_Y, label = ~BREAK_DATE)
leaflet(data = df %>% filter(BREAK_YEAR == 2016)) %>% addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y, label = ~BREAK_DATE)
addCircleMarkers(~POINT_X, ~POINT_Y, label = ~BREAK_DATE, color = ~BREAK_YEAR)
addCircleMarkers(~POINT_X, ~POINT_Y, label = ~BREAK_DATE, color = ~pal(BREAK_YEAR))
?addCircleMarkers
addCircleMarkers(lng=~POINT_X, lat=~POINT_Y, label = ~BREAK_DATE, color = ~pal(BREAK_YEAR))
addCircleMarkers(., lng=~POINT_X, lat=~POINT_Y, label = ~BREAK_DATE, color = ~pal(BREAK_YEAR))
addCircleMarkers(~POINT_X, ~POINT_Y, label = ~BREAK_DATE, color = ~pal(BREAK_YEAR))
addCircleMarkers(~POINT_X, ~POINT_Y, label = ~BREAK_DATE, color = ~colorFactor(BREAK_YEAR))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2000:2016)) %>%
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2000:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y, label = ~BREAK_DATE, color = ~colorFactor(BREAK_YEAR))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2000:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y, label = ~BREAK_DATE, color = ~colorFactor(BREAK_YEAR))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2000:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y, label = ~BREAK_DATE, color = ~(BREAK_YEAR))
df %>% filter(BREAK_YEAR %in% c(2000:2016))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2000:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y, label = ~BREAK_DATE, color = ~as.factor(BREAK_YEAR))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2000:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y, label = ~BREAK_DATE, color = ~as.factor(BREAK_YEAR), stroke=FALSE)
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~as.factor(BREAK_YEAR), stroke=FALSE)
pal <- colorFactor(c("navy", "red"))
pal <- colorFactor(c("navy", "red"), domain = c("2015", "2015"))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~as.factor(BREAK_YEAR), stroke=FALSE)
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke=FALSE)
pal
library(here)
library(rgdal)
library(sp)
library(sf)
library(leaflet)
library(dplyr)
list.files("data", "WatermainBreaks_wgs84")
d_raw <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
sf_d <- st_as_sf(d_raw)
sf_d %>% glimpse()
sf::st_crs(sf_d) #CRS
sf_d <- sf::st_set_crs(sf_d, 4326)
crs <- leaflet::leafletCRS(proj4def = sf::st_crs(sf_d))
st_crs(sf_d) <- sf::st_crs(sf_d)
leaflet(options = leafletOptions(crs = crs))
leaflet::leaflet(sf_d) %>% addTiles(~POINT_X, ~POINT_Y)
st_geometry(sf_d) <- NULL
df <- sf_d
pal <- colorFactor(c("navy", "red"), domain = c("2015", "2015"))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke=FALSE)
df %>% filter(BREAK_YEAR %in% c(2015:2016)) %>% count(BREAK_YEAR)
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR))
pal <- colorFactor(c("navy", "red"), domain = c("2015", "2016"))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke = FALSE)
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke = FALSE, fillOpacity = 1)
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke = FALSE, fillOpacity = 0.75)
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke = FALSE, fillOpacity = 0.75) %>%
addMarkers(
clusterOptions = markerClusterOptions()
)
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke = FALSE, fillOpacity = 0.75,
clusterOptions = markerClusterOptions())
?markerClusterOptions
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke = FALSE, fillOpacity = 0.75,
clusterOptions = markerClusterOptions())
rm(list=ls())
gc()
library(here)
library(rgdal)
library(sp)
library(sf)
library(leaflet)
library(dplyr)
list.files("data", "WatermainBreaks_wgs84")
d_raw <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
sf_d <- st_as_sf(d_raw)
sf_d %>% glimpse()
class(sf_d)
sf::st_crs(sf_d) #CRS
crs <- leaflet::leafletCRS(proj4def = sf::st_crs(sf_d))
sf_d <- sf::st_set_crs(sf_d, 4326) #set the CRS EPSG code to WGS84 which is 4326
crs <- leaflet::leafletCRS(proj4def = sf::st_crs(sf_d)) #now reproject
st_crs(sf_d) <- sf::st_crs(sf_d)
?st_crs
?st_transform
st_transform(sf_d, crs = crs)
st_transform(sf_d, crs = sf::st_crs(sf_d))
rm(list=ls())
library(here)
library(rgdal)
library(sp)
library(sf)
library(leaflet)
library(dplyr)
list.files("data", "WatermainBreaks_wgs84")
d_raw <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
sf_d <- st_as_sf(d_raw)
sf_d %>% glimpse()
st_transform(sf_d, crs = sf::st_crs(sf_d))
sf::st_crs(sf_d)
sf_d <- sf::st_set_crs(sf_d, 4326) #set the CRS EPSG code to WGS84 which is 4326
sf::st_crs(sf_d)
crs <- leaflet::leafletCRS(proj4def = sf::st_crs(sf_d)) #now reproject
crs
sf_d <- st_transform(sf_d, crs = sf::st_crs(sf_d)) #now reproject data
st_crs(sf_d) <- sf::st_crs(sf_d)
rm(list=ls())
library(here)
library(rgdal)
library(sp)
library(sf)
library(leaflet)
library(dplyr)
list.files("data", "WatermainBreaks_wgs84")
d_raw <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
sf_d <- st_as_sf(d_raw)
sf_d %>% glimpse()
sf::st_crs(sf_d) #CRS, missing EPSG code
sf_d <- sf::st_set_crs(sf_d, 4326) #set the CRS EPSG code to WGS84 which is 4326
# need to change this because Leaflet's default projection is 3857 (Google Mercator)
leaflet::leaflet(sf_d) %>% addTiles(~POINT_X, ~POINT_Y)
leaflet::leaflet(sf_d %>% filter(BREAK_YEAR == "2012")) %>% addTiles() %>%
addMarkers()
sf_d
sf_d %>% select(lon=POINT_X, lat=POINT_Y) %>% leaflet %>% addTiles %>% addCircleMarkers()
sf_d
df <- sf_d
pal <- colorFactor(c("navy", "red"), domain = c("2015", "2016"))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke = FALSE, fillOpacity = 0.75,
clusterOptions = markerClusterOptions())
sf_d <- st_transform(sf_d, crs = sf::st_crs(sf_d)) #now reproject data
sf_d
library(here)
library(rgdal)
library(sp)
library(sf)
library(leaflet)
library(dplyr)
list.files("data", "WatermainBreaks_wgs84")
d_raw <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
sf_d <- st_as_sf(d_raw)
sf_d %>% glimpse()
sf::st_crs(sf_d) #CRS, missing EPSG code
sf_d <- sf::st_set_crs(sf_d, 4326) #set the CRS EPSG code to WGS84 which is 4326
# need to change this because Leaflet's default projection is 3857 (Google Mercator)
sf_d <- st_transform(sf_d, crs = sf::st_crs(sf_d)) #now reproject data
sf_d %>% filter(BREAK_YEAR == "2012") %>% leaflet() %>% addTiles() %>%
addMarkers()
sf_d %>% filter(BREAK_YEAR == "2012") %>%
select(lng=POINT_X, lat=POINT_Y)
sf_d %>% filter(BREAK_YEAR == "2012") %>%
select(lng=POINT_X, lat=POINT_Y) %>%
leaflet() %>% addTiles() %>%
addMarkers()
sf_d %>% filter(BREAK_YEAR == "2012") %>%
select(lat=POINT_X, lng=POINT_Y) %>%
leaflet() %>% addTiles() %>%
addMarkers()
sf_d %>% filter(BREAK_YEAR == "2012") %>%
select(lat=POINT_X, lng=POINT_Y) %>%
leaflet() %>% addTiles() %>%
addMarkers(~lng, ~lat)
sf_d %>% filter(BREAK_YEAR == "2012") %>%
select(lng=POINT_X, lat=POINT_Y) %>%
leaflet() %>% addTiles() %>%
addMarkers(~lng, ~lat)
?addMarkers
getMapData(sf_d)
?getMapData(map = )
sf_d %>% filter(BREAK_YEAR == "2012") %>%
select(lng=POINT_X, lat=POINT_Y) %>%
leaflet() %>% addTiles() %>%
addMarkers(~lng, ~lat)
leaflet::leaflet(sf_d %>% filter(BREAK_YEAR == "2012")) %>% addTiles() %>%
addMarkers()
st_geometry(sf_d)
st_geometry(sf_d) <- NULL
sf_d
library(here)
library(rgdal)
library(sp)
library(sf)
library(leaflet)
library(dplyr)
list.files("data", "WatermainBreaks_wgs84")
d_raw <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
sf_d <- st_as_sf(d_raw)
sf_d %>% glimpse()
sf::st_crs(sf_d) #CRS, missing EPSG code
sf_d <- sf::st_set_crs(sf_d, 4326) #set the CRS EPSG code to WGS84 which is 4326
# need to change this because Leaflet's default projection is 3857 (Google Mercator)
sf_d <- st_transform(sf_d, crs = sf::st_crs(sf_d)) #now reproject data
# setting leaflet options is OPTIONAL as we just set the CRS for the data
# leaflet(options = leafletOptions(crs = leaflet::leafletCRS(proj4def = sf::st_crs(sf_d))))
sf_d %>% filter(BREAK_YEAR == "2012") %>%
select(lng=POINT_X, lat=POINT_Y) %>%
leaflet() %>% addTiles() %>%
addMarkers(~lng, ~lat)
df <- sf_d
st_geometry(df) <- NULL
pal <- colorFactor(c("navy", "red"), domain = c("2015", "2016"))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke = FALSE, fillOpacity = 0.75,
clusterOptions = markerClusterOptions())
sf_d %>% filter(BREAK_YEAR == "2012") %>%
select(lng=POINT_X, lat=POINT_Y) %>%
leaflet() %>% addTiles() %>%
addMarkers(~lng, ~lat)
dim(sf_d)
library(here)
library(rgdal)
library(sp)
library(sf)
library(leaflet)
library(dplyr)
list.files("data", "WatermainBreaks_wgs84")
d_raw <- readOGR(here::here("data", "WatermainBreaks_wgs84"))
sf_d <- st_as_sf(d_raw)
sf_d %>% glimpse()
sf::st_crs(sf_d) #CRS, missing EPSG code
sf_d <- sf::st_set_crs(sf_d, 4326) #set the CRS EPSG code to WGS84 which is 4326
# need to change this because Leaflet's default projection is 3857 (Google Mercator)
sf_d <- st_transform(sf_d, crs = sf::st_crs(sf_d)) #now reproject data
# setting leaflet options is OPTIONAL as we just set the CRS for the data
# leaflet(options = leafletOptions(crs = leaflet::leafletCRS(proj4def = sf::st_crs(sf_d))))
sf_d %>% filter(BREAK_YEAR == "2012") %>%
select(lng=POINT_X, lat=POINT_Y) %>%
leaflet() %>% addTiles() %>%
addMarkers(~lng, ~lat)
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke = FALSE, fillOpacity = 0.75,
clusterOptions = markerClusterOptions())
df <- sf_d
st_geometry(df) <- NULL
pal <- colorFactor(c("navy", "red"), domain = c("2015", "2016"))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke = FALSE, fillOpacity = 0.75,
clusterOptions = markerClusterOptions())
sf_d %>% filter(BREAK_YEAR == "2012") %>%
select(lng=POINT_X, lat=POINT_Y) %>%
leaflet() %>% addTiles() %>%
addMarkers(~lng, ~lat)
pal <- colorFactor(c("navy", "red"), domain = c("2015", "2016"))
leaflet(data = df %>% filter(BREAK_YEAR %in% c(2015:2016))) %>%
addTiles() %>%
addCircleMarkers(~POINT_X, ~POINT_Y,
label = ~BREAK_DATE, color = ~pal(BREAK_YEAR), stroke = FALSE, fillOpacity = 0.75,
clusterOptions = markerClusterOptions())
# Initialize Session ####
cat("\014")
rm(list=ls())
cat("\014")
Sys.Date()
sessionInfo()
list.of.packages <- c("readr","readxl","ggplot2","plyr","tidyr","dplyr","magrittr",
"viridis","lubridate","grid","gridExtra",
"maps","ggmap","cluster","knitr","dygraphs","xts")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
lapply(list.of.packages, require, character.only = TRUE)
getwd()
watermain.files <- list.files("data", pattern = "\\.xlsx$")
# Data ####
wm.df <- read_excel(paste0("data/",watermain.files))
wm.df
